<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PromptTree â€” AIã«ä¼ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆå›³ãƒ¡ãƒ¼ã‚«ãƒ¼</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
body { font-family:'Inter',sans-serif; transition: background-color 0.3s,color 0.3s; }
body.dark { background-color:#1a202c; color:#e2e8f0; }
textarea.sample-active { background-color:#f0f0f0; color:#888; } /* ã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤ºä¸­ */
textarea.user-input { background-color:#fff; color:inherit; }       /* å…¥åŠ›ä¸­ */
</style>
</head>
<body class="bg-gray-50 text-gray-800 flex flex-col min-h-screen">

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<header class="bg-white shadow-sm p-4 sticky top-0 z-10 rounded-b-lg flex justify-between items-center">
  <div>
    <h1 class="text-2xl font-bold text-blue-600">PromptTree</h1>
    <p class="text-sm text-gray-600 dark:text-gray-400">AIã«æ­£ç¢ºã«ä¼ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆå›³ãƒ¡ãƒ¼ã‚«ãƒ¼ â€” ã‚³ãƒ¼ãƒ‰ã‚„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‚’åŠ¹ç‡åŒ–</p>
  </div>
  <button id="darkModeToggle" class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600">ğŸŒ™</button>
</header>

<main class="flex-grow container mx-auto p-4 md:p-8 grid grid-cols-1 lg:grid-cols-2 gap-6">

<!-- èª¬æ˜æ–‡ -->
<section class="bg-white p-6 rounded-lg shadow-md lg:col-span-2">
  <h2 class="text-xl font-semibold mb-3">PromptTreeã®ç›®çš„ãƒ»é­…åŠ›</h2>
  <ul class="list-disc pl-5 text-gray-700 dark:text-gray-300">
    <li>è¤‡é›‘ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’AIã«æ­£ç¢ºã«ä¼ãˆã‚‹ã®ãŒç°¡å˜ã«ãªã‚‹</li>
    <li>READMEã‚„æŠ€è¡“ãƒ–ãƒ­ã‚°ã€ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ã«æ´»ç”¨å¯èƒ½</li>
    <li>ã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤º/éè¡¨ç¤ºã§ç›´æ„Ÿçš„ã«å­¦ç¿’ãƒ»ç¢ºèªã§ãã‚‹</li>
    <li>Markdownã‚„çµµæ–‡å­—ã‚’ç°¡å˜ã«åˆ‡æ›¿ãˆå¯èƒ½</li>
  </ul>
</section>

<!-- å…¥åŠ› -->
<section class="bg-white p-6 rounded-lg shadow-md">
  <h2 class="text-xl font-semibold mb-4">å…¥åŠ› (ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã§éšå±¤è¡¨ç¾)</h2>
  <textarea id="inputText" class="w-full h-64 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 sample-active"></textarea>

  <div class="mt-4 flex flex-wrap gap-3">
    <button id="sampleButton" class="flex-1 min-w-[120px] bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg">ã‚µãƒ³ãƒ—ãƒ«éè¡¨ç¤º</button>
    <button id="clearButton" class="flex-1 min-w-[120px] bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg">å…¨å‰Šé™¤</button>
    <div class="flex-1 min-w-[120px] flex items-center bg-gray-100 rounded-lg p-2">
      <span class="mr-2 text-sm">çµµæ–‡å­—</span>
      <input type="checkbox" id="emojiToggle">
    </div>
    <div class="flex-1 min-w-[120px] flex items-center bg-gray-100 rounded-lg p-2">
      <span class="mr-2 text-sm">Markdown</span>
      <input type="checkbox" id="markdownToggle">
    </div>
  </div>
</section>

<!-- å‡ºåŠ› -->
<section class="bg-white p-6 rounded-lg shadow-md">
  <h2 class="text-xl font-semibold mb-4">å‡ºåŠ› (ç”Ÿæˆã•ã‚ŒãŸæ§‹æˆå›³)</h2>
  <pre id="outputCode" class="w-full h-64 p-3 border border-gray-300 rounded-lg bg-gray-100 overflow-auto text-sm whitespace-pre-wrap break-words"></pre>
  <div class="mt-4 flex justify-end gap-2">
    <button id="copyButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">ã‚³ãƒ”ãƒ¼</button>
  </div>
  <div id="copyMessage" class="mt-2 text-center text-sm text-green-600 hidden">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</div>
</section>

</main>

<footer class="bg-white shadow-inner p-4 mt-6 rounded-t-lg text-center text-gray-600 dark:text-gray-400">
&copy; 2025 PromptTree. All rights reserved.
</footer>

<script>
// ----------------------
// DOMå–å¾—
// ----------------------
const inputText = document.getElementById('inputText');
const outputCode = document.getElementById('outputCode');
const sampleButton = document.getElementById('sampleButton');
const clearButton = document.getElementById('clearButton');
const copyButton = document.getElementById('copyButton');
const emojiToggle = document.getElementById('emojiToggle');
const markdownToggle = document.getElementById('markdownToggle');
const darkModeToggle = document.getElementById('darkModeToggle');
const copyMessage = document.getElementById('copyMessage');

// ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚­ã‚¹ãƒˆ
const sampleText = `my_project
  src
    components
      Header.jsx
      Footer.jsx
    pages
      index.jsx
      about.jsx
  README.md
  package.json`;

// çŠ¶æ…‹ç®¡ç†
let sampleVisible = true;
let originalInput = '';

// ----------------------
// UIæ›´æ–°
// ----------------------
function updateSampleUI(){
  if(sampleVisible){
    inputText.classList.add('sample-active');
    inputText.classList.remove('user-input');
    sampleButton.textContent = "ã‚µãƒ³ãƒ—ãƒ«éè¡¨ç¤º";
  } else {
    inputText.classList.remove('sample-active');
    inputText.classList.add('user-input');
    sampleButton.textContent = "ã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤º";
  }
}

// ----------------------
// ãƒ„ãƒªãƒ¼ç”Ÿæˆ
// ----------------------
function generateTree(){
  if(!inputText.value.trim()){ outputCode.textContent=''; return; }

  const lines = inputText.value.split('\n').filter(l=>l.trim()!=='');
  const useEmoji = emojiToggle.checked;
  let output=[];

  const parsed = lines.map(line=>{
    const indent = line.match(/^\s*/)[0].length/2;
    return {indent, name: line.trim()};
  });

  for(let i=0;i<parsed.length;i++){
    const cur = parsed[i];
    let prefix='';
    for(let j=0;j<cur.indent;j++){
      let hasSibling=false;
      for(let k=i+1;k<parsed.length;k++){
        if(parsed[k].indent===j){ hasSibling=true; break; }
        if(parsed[k].indent<j) break;
      }
      prefix += hasSibling ? 'â”‚   ' : '    ';
    }
    let isLast=true;
    for(let k=i+1;k<parsed.length;k++){
      if(parsed[k].indent===cur.indent){ isLast=false; break; }
      if(parsed[k].indent<cur.indent) break;
    }
    const linePrefix = cur.indent>0 ? (isLast ? 'â””â”€â”€ ':'â”œâ”€â”€ ') : '';
    const icon = useEmoji ? (cur.name.includes('.')?'ğŸ“„ ':'ğŸ“ ') : '';
    output.push(`${prefix}${linePrefix}${icon}${cur.name}`);
  }

  let text = output.join('\n');
  if(markdownToggle.checked) text='```\n'+text+'\n```';
  outputCode.textContent = text;
}

// ----------------------
// Tabã‚­ãƒ¼ã§ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ
// ----------------------
inputText.addEventListener('keydown', function(e){
  if(e.key==='Tab'){
    e.preventDefault();
    const start=this.selectionStart;
    const end=this.selectionEnd;
    this.value=this.value.substring(0,start)+'  '+this.value.substring(end);
    this.selectionStart=this.selectionEnd=start+2;
    generateTree();
  }
});

// ----------------------
// å…¥åŠ›é–‹å§‹ã§ã‚µãƒ³ãƒ—ãƒ«éè¡¨ç¤º
// ----------------------
inputText.addEventListener('input', ()=>{
  if(sampleVisible){
    originalInput='';
    hideSample();
  } else {
    originalInput = inputText.value;
    generateTree();
  }
});

// ----------------------
// ã‚µãƒ³ãƒ—ãƒ«è¡¨ç¤º / éè¡¨ç¤º
// ----------------------
function showSample(){
  sampleVisible=true;
  inputText.value = sampleText;
  originalInput='';
  updateSampleUI();
  generateTree();
}
function hideSample(){
  sampleVisible=false;
  inputText.value = originalInput;
  updateSampleUI();
  generateTree();
}
sampleButton.addEventListener('click', ()=>{ sampleVisible?hideSample():showSample(); });

// ----------------------
// å…¨å‰Šé™¤
// ----------------------
clearButton.addEventListener('click', ()=>{
  inputText.value='';
  outputCode.textContent='';
  sampleVisible=false;
  originalInput='';
  updateSampleUI();
});

// ----------------------
// ã‚³ãƒ”ãƒ¼
// ----------------------
copyButton.addEventListener('click', ()=>{
  const ta=document.createElement('textarea');
  ta.value=outputCode.textContent;
  document.body.appendChild(ta);
  ta.select();
  document.execCommand('copy');
  document.body.removeChild(ta);
  copyMessage.classList.remove('hidden');
  setTimeout(()=>copyMessage.classList.add('hidden'),2000);
});

// ----------------------
// Markdownåˆ‡æ›¿ãƒ»Emojiåˆ‡æ›¿
// ----------------------
markdownToggle.addEventListener('change', generateTree);
emojiToggle.addEventListener('change', generateTree);

// ----------------------
// ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰
// ----------------------
darkModeToggle.addEventListener('click', ()=>{
  document.body.classList.toggle('dark');
  localStorage.setItem('darkMode', document.body.classList.contains('dark'));
});
function applyInitialDarkMode(){
  const saved = localStorage.getItem('darkMode');
  if(saved==='true') document.body.classList.add('dark');
  else if(!saved && window.matchMedia('(prefers-color-scheme: dark)').matches)
    document.body.classList.add('dark');
}

// åˆæœŸåŒ–
window.onload = ()=>{
  applyInitialDarkMode();
  showSample();
};
</script>
</body>
</html>
